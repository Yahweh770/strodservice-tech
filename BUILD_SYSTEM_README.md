# Система сборки EXE файлов для проекта StrodService

## Обзор

Этот проект включает автоматическую систему сборки исполняемых файлов (EXE) для приложения StrodService. Система позволяет создавать portable версии приложения, которые можно использовать без установки Python или других зависимостей.

## Структура проекта

- `main.py` - основная точка входа в приложение
- `doc_tracking_system.py` - основная логика системы учета документов
- `build-pyinstaller.sh` - скрипт сборки для Linux/macOS
- `build-release.bat` - скрипт сборки для Windows
- `.github/workflows/build-exe-all-platforms.yml` - GitHub Actions workflow для автоматической сборки

## Автоматическая сборка с помощью GitHub Actions

### Сборка при каждом изменении

GitHub Actions автоматически собирает EXE файлы при каждом пуше в ветку `main` или при создании Pull Request. Workflow находится в файле `.github/workflows/build-exe-all-platforms.yml`.

Workflow собирает исполняемые файлы для трех платформ:
- Windows (создается файл `doc_tracking_system.exe`)
- Linux (создается файл `doc_tracking_system`)
- macOS (создается файл `doc_tracking_system`)

### Скачивание артефактов

После успешной сборки, артефакты (исполняемые файлы) доступны для скачивания в разделе "Actions" репозитория:

1. Перейдите на вкладку "Actions"
2. Выберите запущенный workflow
3. Найдите секцию "Artifacts"
4. Скачайте архив с исполняемым файлом для нужной платформы

## Ручная сборка

### Linux/macOS

1. Убедитесь, что установлен Python 3.9+
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Запустите скрипт сборки:
   ```bash
   chmod +x build-pyinstaller.sh
   ./build-pyinstaller.sh
   ```
4. Готовый исполняемый файл будет находиться в папке `dist/`

### Windows

1. Убедитесь, что установлен Python 3.9+
2. Установите зависимости:
   ```cmd
   pip install -r requirements.txt
   ```
3. Запустите скрипт сборки:
   ```cmd
   build-release.bat
   ```
4. Готовый исполняемый файл будет находиться в папке `dist/`

## Особенности сборки

- Используется PyInstaller для создания standalone исполняемых файлов
- Включаются все необходимые зависимости (SQLite, библиотеки Python)
- Добавляется файл базы данных `pto_docs.db` в сборку
- Добавляется иконка приложения из `assets/icon.ico`
- Создается консольное приложение (не GUI)

## Использование собранного EXE файла

После запуска исполняемого файла, пользователь получает доступ к CLI интерфейсу системы учета документов:

```
=== Система учета документов ПТО ===
1. Добавить документ
2. Отправить документ
3. Зафиксировать возврат документа
4. Просмотреть все документы
5. Найти документ
6. Выход
```

## Устранение неполадок

### Проблемы с зависимостями

Если возникают ошибки во время сборки, убедитесь, что:
- Установлены все зависимости из `requirements.txt`
- Версия Python совместима (рекомендуется 3.9-3.11)
- Достаточно свободного места на диске

### Проблемы с запуском

Если собранное приложение не запускается:
- Проверьте, что используется подходящая архитектура (32/64 бит)
- Убедитесь, что система поддерживает запуск исполняемых файлов с данной платформы
- Попробуйте запустить из командной строки для просмотра ошибок

## Релиз-менеджмент

Для создания официальных релизов используйте систему тегов GitHub:

1. Создайте тег в формате `vX.Y.Z` (например, `v1.0.0`)
2. Запушьте тег в репозиторий: `git push origin vX.Y.Z`
3. GitHub Actions автоматически создаст полноценный релиз с артефактами для всех платформ

См. также файл `RELEASE_GUIDE.md` для подробной информации о системе релизов.